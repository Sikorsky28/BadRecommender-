# Настройка Telegram бота

## Шаг 1: Создание бота в Telegram

1. Откройте Telegram и найдите @BotFather
2. Отправьте команду `/newbot`
3. Следуйте инструкциям:
   - Введите имя бота (например, "Soloways Recommendations Bot")
   - Введите username бота (например, "SolowaysRecommendationsBot")
4. Сохраните полученный токен

## Шаг 2: Настройка переменных окружения

### Для локальной разработки
Добавьте в переменные окружения:

```bash
TELEGRAM_BOT_ENABLED=true
TELEGRAM_BOT_TOKEN=ваш_токен_бота
TELEGRAM_BOT_USERNAME=ваш_username_бота
```

### Для Render.com
В настройках сервиса добавьте переменные:

```
TELEGRAM_BOT_ENABLED = true
TELEGRAM_BOT_TOKEN = ваш_токен_бота
TELEGRAM_BOT_USERNAME = ваш_username_бота
```

## Шаг 3: Функциональность бота

### Команды бота:
- `/start` - Начать опрос заново
- `/help` - Показать справку
- `/reset` - Сбросить текущий опрос

### Процесс работы:
1. Пользователь отправляет `/start`
2. Бот запрашивает email
3. Пользователь проходит опрос (15 вопросов)
4. Результаты отправляются на email
5. Бот предлагает начать новый опрос

## Шаг 4: Тестирование

1. Найдите вашего бота в Telegram
2. Отправьте `/start`
3. Проверьте, что бот отвечает
4. Пройдите тестовый опрос

## Шаг 5: Мониторинг

### Логи для отслеживания:
- Получение сообщений
- Ошибки отправки сообщений
- Ошибки отправки email
- Количество активных пользователей

### Метрики:
- Количество пользователей
- Количество завершенных опросов
- Время прохождения опроса

## Безопасность

### Важные моменты:
- Токен бота должен быть секретным
- Не публикуйте токен в коде
- Используйте переменные окружения
- Регулярно меняйте токен при необходимости

### Ограничения:
- Бот работает только с текстовыми сообщениями
- Максимум 15 вопросов в опросе
- Email валидируется перед сохранением

## Возможные проблемы

### Бот не отвечает:
1. Проверьте, что `TELEGRAM_BOT_ENABLED=true`
2. Проверьте правильность токена
3. Проверьте логи приложения

### Ошибки отправки email:
1. Проверьте настройки SMTP
2. Проверьте логи EmailService
3. Убедитесь, что email валидный

### Проблемы с опросом:
1. Используйте `/reset` для сброса
2. Проверьте логи TelegramBotService
3. Убедитесь, что все сервисы работают

## Интеграция с существующей системой

Бот интегрирован с:
- ✅ EmailService - для отправки результатов
- ✅ RecommendationService - для обработки ответов
- ✅ GoogleSheetsService - для сохранения данных
- ✅ Существующей логикой опросов

## Дополнительные возможности

### Планы развития:
- [ ] Сохранение результатов в Google Sheets
- [ ] Персонализированные рекомендации
- [ ] Статистика и аналитика
- [ ] Многоязычная поддержка
- [ ] Интеграция с CRM

### Настройки бота:
- [ ] Настройка времени ожидания
- [ ] Кастомизация сообщений
- [ ] Добавление новых команд
- [ ] Интеграция с платежами
